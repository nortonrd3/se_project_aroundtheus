!function(){"use strict";class e{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_toggleButtonState(e){this._hasInvalidInput(e)?this.disableButton():this._enableButton()}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_setEventListeners(){const e=Array.from(this._formElement.querySelectorAll(this._inputSelector));this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._toggleButtonState(e),e.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState(e)}))}))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class t{constructor(e,t,s,r,i){this._name=e.name,this._link=e.link,this.id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleLikeIcon=r,this.handleDeleteCard=i}_setEventListeners(){this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this.handleDeleteCard(this)})),this._cardImageElement.addEventListener("click",(()=>{this._handleImagePreview(this._name,this._link)})),this._likeButton.addEventListener("click",(()=>{this._handleLikeIcon(this)}))}_handleLikeIcon(){this._likeButton.classList.toggle("card__like-button_active")}_renderLikes(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}handleLike(e){this._isLiked=e,this._renderLikes()}getCardId(){return this.id}getIsLiked(){return this._isLiked}remove(){this._cardElement.remove(),this._cardElement=null}_handleImagePreview(){this._handleImageClick(this._name,this._link)}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._cardImageElement=this._cardElement.querySelector(".card__image"),this._cardTitleElement=this._cardElement.querySelector(".card__title"),this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._cardTitleElement.textContent=this._name,this._setEventListeners(),this._renderLikes(this._isLiked),this._cardElement}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".modal__close"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._closeButton.addEventListener("click",(()=>this.close())),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()}))}}class r extends s{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=s,this._submitButton=this._popupForm.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent,this._inputList=Array.from(this._popupForm.querySelectorAll(".modal__input"))}_getInputValues(){return this._popupFormValues={},this._inputList.forEach((e=>{this._popupFormValues[e.name]=e.value})),this._popupFormValues}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}renderLoadingText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}}class i{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const n={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},o=document.querySelector("#profile-edit-button"),a=document.querySelector("#profile-edit-modal"),l=document.querySelector("#add-card-modal"),d=document.querySelector("#edit-avatar-modal"),c=document.querySelector("#profile-title-input"),h=document.querySelector("#profile-description-input"),u=a.querySelector(".modal__form"),_=l.querySelector(".modal__form"),m=document.querySelector(".profile__add-button"),p=document.querySelector(".profile__avatar-button"),v=d.querySelector(".modal__form");function E(e,t){w.open(e,t)}p.addEventListener("click",(()=>q.open())),o.addEventListener("click",(()=>{const e=S.getUserInfo();c.value=e.name,h.value=e.description,B.open()})),m.addEventListener("click",(()=>C.open()));const S=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._name=document.querySelector(t),this._job=document.querySelector(s),this._avatar=document.querySelector(r)}getUserInfo(){return{name:this._name.textContent,description:this._job.textContent,avatar:this._avatar.src}}setUserInfo(e){this._name.textContent=e.title,this._job.textContent=e.description}updateAvatar(e){this._avatar.src=e}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"}),b=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handlePromise(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handlePromise)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handlePromise)}getAllData(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}updateUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.title,about:e.description})}).then(this._handlePromise)}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._handlePromise)}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._handlePromise)}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._handlePromise)}addCard(e){let{name:t,link:s,_id:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s,_id:r})}).then(this._handlePromise)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handlePromise)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"6f07cb37-e9a8-4f19-ad7e-e33ed7b58580","Content-Type":"application/json"}});let L;b.getAllData().then((e=>{let[t,s]=e;S.updateAvatar(s.avatar),S.setUserInfo({title:s.name,description:s.about}),L=new i({items:t,renderer:g},".cards__list"),L.renderItems()})).catch((e=>console.error(e)));const f=new e(n,_);f.enableValidation(),new e(n,u).enableValidation();const k=new e(n,v);k.enableValidation();const g=e=>{const s=function(e){return new t(e,"#card-template",E,y,I).getView()}(e);L.addItem(s)};function y(e){e.getIsLiked()?b.removeLike(e.getCardId()).then((()=>{e.handleLike(!1)})).catch((e=>{console.error(e)})):b.addLike(e.getCardId()).then((()=>{e.handleLike(!0)})).catch((e=>{console.error(e)}))}function I(e){x.open(),x.confirmDeletion((()=>{b.deleteCard(e.getCardId()).then((()=>{e.remove(),x.close()})).catch((e=>{console.error("Error deleting card",e)}))}))}const C=new r({popupSelector:"#add-card-modal",handleFormSubmit:function(e){C.renderLoadingText(!0),b.addCard({name:e.name,link:e.link,_id:e.id,isLiked:e.isLiked}).then((e=>{g(e),C.close(),_.reset(),f.disableButton()})).catch((e=>{console.error("Error while adding card",e)})).finally((()=>{C.renderLoadingText(!1)}))}});C.setEventListeners();const B=new r({popupSelector:"#profile-edit-modal",handleFormSubmit:function(e){B.renderLoadingText(!0),b.updateUserInfo(e).then((e=>{S.setUserInfo({title:e.name,description:e.about}),B.close()})).catch((e=>{console.error(e)})).finally((()=>{B.renderLoadingText(!1)}))}});B.setEventListeners();const q=new r({popupSelector:"#edit-avatar-modal",handleFormSubmit:function(e){q.renderLoadingText(!0),b.updateAvatar(e).then((e=>{S.updateAvatar(e.avatar),q.close(),v.reset(),k.disableButton()})).catch((e=>{console.error("Error updating avatar",e)})).finally((()=>{q.renderLoadingText(!1)}))}});q.setEventListeners();const w=new class extends s{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._image=this._popupElement.querySelector(".modal__card-image"),this._title=this._popupElement.querySelector(".modal__card-title")}open(e,t){this._title.textContent=e,this._image.alt=e,this._image.src=t,super.open()}}({popupSelector:"#preview-image-modal"});w.setEventListeners();const x=new class extends s{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super({popupSelector:t}),this._handleFormSubmit=s,this._deleteButton=this._popupElement.querySelector(".card__delete-button"),this._isSubmitted=!1,this._cardId=null,this._card=null}open(e,t){this._card=e,this._cardId=t,super.open()}getIsSubmitted(){return this._isSubmitted}confirmDeletion(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("click",(e=>{e.preventDefault(),this._isSubmitted=!0,this._handleFormSubmit(this._card,this._cardId)}))}}({popupSelector:"#remove-card-modal",handleFormSubmit:()=>{}});x.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TSxLQUFLOEUsY0FBYy9ELGNBQWMscUJBQ2pELENBRUFtRSxJQUFBQSxDQUFLaEMsRUFBTUUsR0FDVHBELEtBQUtvTSxPQUFPakwsWUFBYytCLEVBQzFCbEQsS0FBS21NLE9BQU96SCxJQUFNeEIsRUFDbEJsRCxLQUFLbU0sT0FBTzFILElBQU1yQixFQUNsQnVDLE1BQU1ULE1BQ1IsR0hxTzJDLENBQzNDTCxjQUFlLHlCQUVqQnVELEVBQWtCOUMsb0JBRWxCLE1BQU15RyxFQUF1QixJSXRQZCxjQUFtQ3BILEVBQ2hEOUUsV0FBQUEsQ0FBVytFLEdBQXNDLElBQXJDLGNBQUVDLEVBQWEsaUJBQUVhLEdBQWtCZCxFQUM3Q2UsTUFBTSxDQUFFZCxrQkFDUjdFLEtBQUs2RixrQkFBb0JILEVBQ3pCMUYsS0FBS3FNLGNBQWdCck0sS0FBSzhFLGNBQWMvRCxjQUN0Qyx3QkFFRmYsS0FBS3NNLGNBQWUsRUFDcEJ0TSxLQUFLdU0sUUFBVSxLQUNmdk0sS0FBS3dNLE1BQVEsSUFDZixDQUVBdEgsSUFBQUEsQ0FBSzRHLEVBQU1XLEdBQ1R6TSxLQUFLd00sTUFBUVYsRUFDYjlMLEtBQUt1TSxRQUFVRSxFQUNmOUcsTUFBTVQsTUFDUixDQUVBd0gsY0FBQUEsR0FDRSxPQUFPMU0sS0FBS3NNLFlBQ2QsQ0FFQU4sZUFBQUEsQ0FBZ0I1QyxHQUNkcEosS0FBSzZGLGtCQUFvQnVELENBQzNCLENBRUE5RCxpQkFBQUEsR0FDRUssTUFBTUwsb0JBQ050RixLQUFLOEUsY0FBY3hDLGlCQUFpQixTQUFVcUssSUFDNUNBLEVBQUlqSyxpQkFDSjFDLEtBQUtzTSxjQUFlLEVBQ3BCdE0sS0FBSzZGLGtCQUFrQjdGLEtBQUt3TSxNQUFPeE0sS0FBS3VNLFFBQVEsR0FFcEQsR0pxTm9ELENBQ3BEMUgsY0FBZSxxQkFDZmEsaUJBQWtCQSxTQUVwQnFHLEVBQXFCekcsbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy91dGlscy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwQ29uZmlybURlbGV0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0RWxlbWVudHMpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KGlucHV0RWxlbWVudHMpKSB7XG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XG4gICAgfVxuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dEVsZW1lbnRzKSB7XG4gICAgcmV0dXJuIGlucHV0RWxlbWVudHMuc29tZSgoaW5wdXRFbGVtZW50KSA9PiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBjb25zdCBpbnB1dEVsZW1lbnRzID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRFbGVtZW50cyk7XG4gICAgaW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRFbGVtZW50cyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGRpc2FibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIF9lbmFibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBkYXRhLFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VJY29uLFxuICAgIGhhbmRsZURlbGV0ZUNhcmRcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuaWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbiA9IGhhbmRsZUxpa2VJY29uO1xuICAgIHRoaXMuaGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLmhhbmRsZURlbGV0ZUNhcmQodGhpcyk7XG4gICAgICB9KTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZVByZXZpZXcodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XG4gICAgfSk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUljb24odGhpcyk7XG4gICAgfSk7XG4gIH1cblxuICBfaGFuZGxlTGlrZUljb24oKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgX3JlbmRlckxpa2VzKCkge1xuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVMaWtlKGlzTGlrZWQpIHtcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICB9XG5cbiAgZ2V0Q2FyZElkKCkge1xuICAgIHJldHVybiB0aGlzLmlkO1xuICB9XG5cbiAgZ2V0SXNMaWtlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faXNMaWtlZDtcbiAgfVxuXG4gIHJlbW92ZSgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBfaGFuZGxlSW1hZ2VQcmV2aWV3KCkge1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XG4gIH1cblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICB0aGlzLl9jYXJkVGl0bGVFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX2NhcmRUaXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcmVuZGVyTGlrZXModGhpcy5faXNMaWtlZCk7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIC8vIG9wZW5zIHBvcHVwXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgLy8gY2xvc2VzIHBvcHVwXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGUpIHtcbiAgICAvLyBsaXN0ZW5zIGZvciBlc2MgYnV0dG9uXG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgLy8gc2V0cyBldmVudCBsaXN0ZW5lcnNcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKVxuICAgICk7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgdGhpcy5fcG9wdXBGb3JtVmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9wb3B1cEZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5fcG9wdXBGb3JtVmFsdWVzO1xuICB9XG5cbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmdUZXh0KGlzTG9hZGluZywgdGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0ZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xuICAgIH1cbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgLy8gUmVuZGVyIGFsbCBlbGVtZW50cyBvbiB0aGUgcGFnZS4gSXRlcmF0ZSB0aHJvdWdoIGl0ZW1zIGFycmF5IGFuZCBjYWxsIHRoZSByZW5kZXJlciBmdW5jdGlvbiBvbiBlYWNoIGl0ZW0uIFRoaXMgc2hvdWxkIGJlIGNhbGxlZCBvbmNlIG9uIHBhZ2UgbG9hZC5cbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oY2FyZEVsZW1lbnQpIHtcbiAgICAvLyB0YWtlcyBhIERPTSBlbGVtZW50IGFuZCBhZGRzIGl0IHRvIHRoZSBjb250YWluZXIuIFNob3VsZCBiZSBjYWxsZWQgd2hlbiBhZGRpbmcgYW4gaW5kaXZpZHVhbCBjYXJkIHRvIHRoZSBET00uXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICB9XG59XG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtVmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbiIsImltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwQ29uZmlybURlbGV0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwQ29uZmlybURlbGV0aW9uLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgeyBmb3JtVmFsaWRhdGlvbkNvbmZpZyB9IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5jb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5jb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xuY29uc3QgY2hhbmdlQXZpdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtYXZhdGFyLW1vZGFsXCIpO1xuXG5jb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgYWRkQ2FyZEZvcm0gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5jb25zdCBlZGl0QXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnV0dG9uXCIpO1xuY29uc3QgYXZhdGFyRm9ybUVsZW1lbnQgPSBjaGFuZ2VBdml0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKG5hbWUsIGxpbmspIHtcbiAgcHJldmlld0ltYWdlUG9wdXAub3BlbihuYW1lLCBsaW5rKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQodXNlckRhdGEpIHtcbiAgZWRpdFByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nVGV4dCh0cnVlKTtcbiAgYXBpXG4gICAgLnVwZGF0ZVVzZXJJbmZvKHVzZXJEYXRhKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgICAgdGl0bGU6IHJlcy5uYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbjogcmVzLmFib3V0LFxuICAgICAgfSk7XG4gICAgICBlZGl0UHJvZmlsZVBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nVGV4dChmYWxzZSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChsaW5rKSB7XG4gIGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nVGV4dCh0cnVlKTtcbiAgYXBpXG4gICAgLnVwZGF0ZUF2YXRhcihsaW5rKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHVzZXJJbmZvLnVwZGF0ZUF2YXRhcihyZXMuYXZhdGFyKTtcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5jbG9zZSgpO1xuICAgICAgYXZhdGFyRm9ybUVsZW1lbnQucmVzZXQoKTtcbiAgICAgIGF2YXRhckZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluZyBhdmF0YXJcIiwgZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nVGV4dChmYWxzZSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoZGF0YSkge1xuICAvLyBjb25zb2xlLmxvZyhkYXRhKTtcbiAgbmV3Q2FyZFBvcHVwLnJlbmRlckxvYWRpbmdUZXh0KHRydWUpO1xuICBhcGlcbiAgICAuYWRkQ2FyZCh7XG4gICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICBsaW5rOiBkYXRhLmxpbmssXG4gICAgICBfaWQ6IGRhdGEuaWQsXG4gICAgICBpc0xpa2VkOiBkYXRhLmlzTGlrZWQsXG4gICAgfSlcbiAgICAudGhlbigoY2FyZERhdGEpID0+IHtcbiAgICAgIHJlbmRlckNhcmQoY2FyZERhdGEpO1xuICAgICAgbmV3Q2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgICBhZGRDYXJkRm9ybS5yZXNldCgpO1xuICAgICAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHdoaWxlIGFkZGluZyBjYXJkXCIsIGVycm9yKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIG5ld0NhcmRQb3B1cC5yZW5kZXJMb2FkaW5nVGV4dChmYWxzZSk7XG4gICAgfSk7XG59XG5cbmVkaXRBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGVkaXRBdmF0YXJQb3B1cC5vcGVuKCkpO1xuXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCBkYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBkYXRhLm5hbWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gZGF0YS5kZXNjcmlwdGlvbjtcbiAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuKCk7XG59KTtcblxuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gbmV3Q2FyZFBvcHVwLm9wZW4oKSk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59KTtcblxuLy8gQVBJXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCI2ZjA3Y2IzNy1lOWE4LTRmMTktYWQ3ZS1lMzNlZDdiNTg1ODBcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5sZXQgc2VjdGlvbjtcblxuYXBpXG4gIC5nZXRBbGxEYXRhKClcbiAgLnRoZW4oKFtpbml0aWFsQ2FyZHMsIHVzZXJEYXRhXSkgPT4ge1xuICAgIHVzZXJJbmZvLnVwZGF0ZUF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgIHRpdGxlOiB1c2VyRGF0YS5uYW1lLFxuICAgICAgZGVzY3JpcHRpb246IHVzZXJEYXRhLmFib3V0LFxuICAgIH0pO1xuICAgIHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHtcbiAgICAgICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICAgICAgcmVuZGVyZXI6IHJlbmRlckNhcmQsXG4gICAgICB9LFxuICAgICAgXCIuY2FyZHNfX2xpc3RcIlxuICAgICk7XG4gICAgc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcblxuLy8gRm9ybSBWYWxpZGF0aW9uXG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICBmb3JtVmFsaWRhdGlvbkNvbmZpZyxcbiAgYWRkQ2FyZEZvcm1cbik7XG5hZGRDYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICBmb3JtVmFsaWRhdGlvbkNvbmZpZyxcbiAgcHJvZmlsZUVkaXRGb3JtXG4pO1xuZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICBmb3JtVmFsaWRhdGlvbkNvbmZpZyxcbiAgYXZhdGFyRm9ybUVsZW1lbnRcbik7XG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuLy8gQ2FyZHNcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIGNhcmREYXRhLFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VJY29uLFxuICAgIGhhbmRsZURlbGV0ZUNhcmRcbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xufVxuXG5jb25zdCByZW5kZXJDYXJkID0gKGNhcmREYXRhKSA9PiB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG4gIHNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XG59O1xuXG4vLyBoYW5kbGUgTGlrZSBJY29uXG5mdW5jdGlvbiBoYW5kbGVMaWtlSWNvbihjYXJkKSB7XG4gIGlmIChjYXJkLmdldElzTGlrZWQoKSkge1xuICAgIGFwaVxuICAgICAgLnJlbW92ZUxpa2UoY2FyZC5nZXRDYXJkSWQoKSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5oYW5kbGVMaWtlKGZhbHNlKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBhcGlcbiAgICAgIC5hZGRMaWtlKGNhcmQuZ2V0Q2FyZElkKCkpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuaGFuZGxlTGlrZSh0cnVlKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxufVxuXG4vLyBoYW5kbGUgZGVsZXRpbmcgY2FyZHNcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZCkge1xuICBjb25maXJtRGVsZXRpb25Qb3B1cC5vcGVuKCk7XG4gIGNvbmZpcm1EZWxldGlvblBvcHVwLmNvbmZpcm1EZWxldGlvbigoKSA9PiB7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLmdldENhcmRJZCgpKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAvLyB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgIGNhcmQucmVtb3ZlKCk7XG4gICAgICAgIGNvbmZpcm1EZWxldGlvblBvcHVwLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRlbGV0aW5nIGNhcmRcIiwgZXJyKTtcbiAgICAgIH0pO1xuICB9KTtcbn1cblxuLy8gSW5zdGFjZSBvZiBTZWN0aW9uIGNsYXNzXG5cbi8vIGNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbi8vICAgeyBpdGVtczogaW5pdGlhbENhcmRzLCByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LFxuLy8gICBcIi5jYXJkc19fbGlzdFwiXG4vLyApO1xuLy8gc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuXG4vLyBQb3B1cHNcblxuY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBwb3B1cFNlbGVjdG9yOiBcIiNhZGQtY2FyZC1tb2RhbFwiLFxuICBoYW5kbGVGb3JtU3VibWl0OiBoYW5kbGVBZGRDYXJkU3VibWl0LFxufSk7XG5uZXdDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0LFxufSk7XG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGVkaXRBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjZWRpdC1hdmF0YXItbW9kYWxcIixcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlQXZhdGFyU3VibWl0LFxufSk7XG5lZGl0QXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcHJldmlld0ltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoe1xuICBwb3B1cFNlbGVjdG9yOiBcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIsXG59KTtcbnByZXZpZXdJbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGNvbmZpcm1EZWxldGlvblBvcHVwID0gbmV3IFBvcHVwQ29uZmlybURlbGV0aW9uKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjcmVtb3ZlLWNhcmQtbW9kYWxcIixcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKCkgPT4ge30sXG59KTtcbmNvbmZpcm1EZWxldGlvblBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fam9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2pvYi50ZXh0Q29udGVudCxcclxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXIuc3JjLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBkYXRhLnRpdGxlO1xyXG4gICAgdGhpcy5fam9iLnRleHRDb250ZW50ID0gZGF0YS5kZXNjcmlwdGlvbjtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUF2YXRhcihhdmF0YXIpIHtcclxuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9oYW5kbGVQcm9taXNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUHJvbWlzZSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUHJvbWlzZSk7XHJcbiAgfVxyXG5cclxuICBnZXRBbGxEYXRhKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVVzZXJJbmZvKHVzZXJEYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogdXNlckRhdGEudGl0bGUsXHJcbiAgICAgICAgYWJvdXQ6IHVzZXJEYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUHJvbWlzZSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXIobGluaykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGxpbmspLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVQcm9taXNlKTtcclxuICB9XHJcblxyXG4gIGFkZExpa2UoSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke0lkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVQcm9taXNlKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUxpa2UoSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke0lkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVQcm9taXNlKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rLCBfaWQsIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rLCBfaWQgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVByb21pc2UpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7SWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVByb21pc2UpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcmQtaW1hZ2VcIik7XHJcbiAgICB0aGlzLl90aXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXJkLXRpdGxlXCIpO1xyXG4gIH1cclxuXHJcbiAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICB0aGlzLl90aXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gbGluaztcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cENvbmZpcm1EZWxldGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcbiAgICApO1xuICAgIHRoaXMuX2lzU3VibWl0dGVkID0gZmFsc2U7XG4gICAgdGhpcy5fY2FyZElkID0gbnVsbDtcbiAgICB0aGlzLl9jYXJkID0gbnVsbDtcbiAgfVxuXG4gIG9wZW4oY2FyZCwgY2FyZElkKSB7XG4gICAgdGhpcy5fY2FyZCA9IGNhcmQ7XG4gICAgdGhpcy5fY2FyZElkID0gY2FyZElkO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxuXG4gIGdldElzU3VibWl0dGVkKCkge1xuICAgIHJldHVybiB0aGlzLl9pc1N1Ym1pdHRlZDtcbiAgfVxuXG4gIGNvbmZpcm1EZWxldGlvbihhcGkpIHtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gYXBpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faXNTdWJtaXR0ZWQgPSB0cnVlO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9jYXJkLCB0aGlzLl9jYXJkSWQpO1xuICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0RWxlbWVudHMiLCJfaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJzb21lIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImRpc2FibGVkIiwiZW5hYmxlVmFsaWRhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIkNhcmQiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZUxpa2VJY29uIiwiaGFuZGxlRGVsZXRlQ2FyZCIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsIl9pc0xpa2VkIiwiaXNMaWtlZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVMaWtlSWNvbiIsIl9jYXJkRWxlbWVudCIsIl9jYXJkSW1hZ2VFbGVtZW50IiwiX2hhbmRsZUltYWdlUHJldmlldyIsIl9saWtlQnV0dG9uIiwidG9nZ2xlIiwiX3JlbmRlckxpa2VzIiwiaGFuZGxlTGlrZSIsImdldENhcmRJZCIsImdldElzTGlrZWQiLCJnZXRWaWV3IiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2NhcmRUaXRsZUVsZW1lbnQiLCJzcmMiLCJhbHQiLCJQb3B1cCIsIl9yZWYiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9jbG9zZUJ1dHRvbiIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfc3VibWl0QnV0dG9uVGV4dCIsIl9pbnB1dExpc3QiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfcG9wdXBGb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwicmVuZGVyTG9hZGluZ1RleHQiLCJpc0xvYWRpbmciLCJ0ZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiY2FyZEVsZW1lbnQiLCJwcmVwZW5kIiwiZm9ybVZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsZWN0b3IiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0TW9kYWwiLCJhZGRDYXJkTW9kYWwiLCJjaGFuZ2VBdml0YXJNb2RhbCIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlRWRpdEZvcm0iLCJhZGRDYXJkRm9ybSIsImFkZE5ld0NhcmRCdXR0b24iLCJlZGl0QXZhdGFyQnV0dG9uIiwiYXZhdGFyRm9ybUVsZW1lbnQiLCJwcmV2aWV3SW1hZ2VQb3B1cCIsImVkaXRBdmF0YXJQb3B1cCIsInVzZXJJbmZvIiwiZ2V0VXNlckluZm8iLCJkZXNjcmlwdGlvbiIsImVkaXRQcm9maWxlUG9wdXAiLCJuZXdDYXJkUG9wdXAiLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX2pvYiIsIl9hdmF0YXIiLCJhdmF0YXIiLCJzZXRVc2VySW5mbyIsInRpdGxlIiwidXBkYXRlQXZhdGFyIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2hhbmRsZVByb21pc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwiZ2V0QWxsRGF0YSIsImFsbCIsInVwZGF0ZVVzZXJJbmZvIiwidXNlckRhdGEiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiYWRkTGlrZSIsIklkIiwicmVtb3ZlTGlrZSIsImFkZENhcmQiLCJfcmVmMiIsImRlbGV0ZUNhcmQiLCJhdXRob3JpemF0aW9uIiwic2VjdGlvbiIsImluaXRpYWxDYXJkcyIsInJlbmRlckNhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsImNhcmREYXRhIiwiY3JlYXRlQ2FyZCIsImNhcmQiLCJjb25maXJtRGVsZXRpb25Qb3B1cCIsImNvbmZpcm1EZWxldGlvbiIsInJlc2V0IiwiZmluYWxseSIsIl9pbWFnZSIsIl90aXRsZSIsIl9kZWxldGVCdXR0b24iLCJfaXNTdWJtaXR0ZWQiLCJfY2FyZElkIiwiX2NhcmQiLCJjYXJkSWQiLCJnZXRJc1N1Ym1pdHRlZCIsImV2dCJdLCJzb3VyY2VSb290IjoiIn0=