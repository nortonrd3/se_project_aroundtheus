!function(){"use strict";class e{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_toggleButtonState(e){this._hasInvalidInput(e)?this.disableButton():this._enableButton()}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_setEventListeners(){const e=Array.from(this._formElement.querySelectorAll(this._inputSelector));this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._toggleButtonState(e),e.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState(e)}))}))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class t{constructor(e,t,s,r,i){this._name=e.name,this._link=e.link,this.id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleLikeIcon=r,this.handleDeleteCard=i}_setEventListeners(){this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this.handleDeleteCard(this)})),this._cardImageElement.addEventListener("click",(()=>{this._handleImagePreview(this._name,this._link)})),this._likeButton.addEventListener("click",(()=>{this._handleLikeIcon(this)}))}_handleLikeIcon(){this._likeButton.classList.toggle("card__like-button_active")}_renderLikes(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}handleLike(e){this._isLiked=e,this._renderLikes()}getCardId(){return this.id}getIsLiked(){return this._isLiked}remove(){this._cardElement.remove(),this._cardElement=null}_handleImagePreview(){this._handleImageClick(this._name,this._link)}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._cardImageElement=this._cardElement.querySelector(".card__image"),this._cardTitleElement=this._cardElement.querySelector(".card__title"),this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._cardTitleElement.textContent=this._name,this._setEventListeners(),this._renderLikes(this._isLiked),this._cardElement}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".modal__close"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._closeButton.addEventListener("click",(()=>this.close())),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()}))}}class r extends s{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=s,this._submitButton=this._popupForm.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent,this._inputList=Array.from(this._popupForm.querySelectorAll(".modal__input"))}_getInputValues(){return this._popupFormValues={},this._inputList.forEach((e=>{this._popupFormValues[e.name]=e.value})),this._popupFormValues}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}renderLoadingText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}}class i{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const n={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},o=document.querySelector("#profile-edit-button"),a=document.querySelector("#profile-edit-modal"),l=document.querySelector("#add-card-modal"),d=document.querySelector("#edit-avatar-modal"),c=document.querySelector("#profile-title-input"),h=document.querySelector("#profile-description-input"),u=a.querySelector(".modal__form"),_=l.querySelector(".modal__form"),m=document.querySelector(".profile__add-button"),p=document.querySelector(".profile__avatar-button"),v=d.querySelector(".modal__form");function E(e,t){w.open(e,t)}p.addEventListener("click",(()=>q.open())),o.addEventListener("click",(()=>{const e=S.getUserInfo();c.value=e.name,h.value=e.description,B.open()})),m.addEventListener("click",(()=>C.open()));const S=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._name=document.querySelector(t),this._job=document.querySelector(s),this._avatar=document.querySelector(r)}getUserInfo(){return{name:this._name.textContent,description:this._job.textContent,avatar:this._avatar.src}}setUserInfo(e){this._name.textContent=e.title,this._job.textContent=e.description}updateAvatar(e){this._avatar.src=e}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"}),b=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handlePromise(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handlePromise)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handlePromise)}getAllData(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}updateUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.title,about:e.description})}).then(this._handlePromise)}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._handlePromise)}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._handlePromise)}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._handlePromise)}addCard(e){let{name:t,link:s,_id:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s,_id:r})}).then(this._handlePromise)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handlePromise)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"6f07cb37-e9a8-4f19-ad7e-e33ed7b58580","Content-Type":"application/json"}});let L;b.getAllData().then((e=>{let[t,s]=e;S.updateAvatar(s.avatar),S.setUserInfo({title:s.name,description:s.about}),L=new i({items:t,renderer:g},".cards__list"),L.renderItems()})).catch((e=>console.error(e)));const f=new e(n,_);f.enableValidation(),new e(n,u).enableValidation();const k=new e(n,v);k.enableValidation();const g=e=>{const s=function(e){return new t(e,"#card-template",E,y,I).getView()}(e);L.addItem(s)};function y(e){e.getIsLiked()?b.removeLike(e.getCardId()).then((()=>{e.handleLike(!1)})).catch((e=>{console.error(e)})):b.addLike(e.getCardId()).then((()=>{e.handleLike(!0)})).catch((e=>{console.error(e)}))}function I(e){x.open(),x.confirmDeletion((()=>{b.deleteCard(e.getCardId()).then((()=>{e.remove(),x.close()})).catch((e=>{console.error("Error deleting card",e)}))}))}const C=new r({popupSelector:"#add-card-modal",handleFormSubmit:function(e){C.renderLoadingText(!0),b.addCard({name:e.name,link:e.link,_id:e.id,isLiked:e.isLiked}).then((e=>{g(e),C.close(),_.reset(),f.disableButton()})).catch((e=>{console.error("Error while adding card",e)})).finally((()=>{C.renderLoadingText(!1)}))}});C.setEventListeners();const B=new r({popupSelector:"#profile-edit-modal",handleFormSubmit:function(e){B.renderLoadingText(!0),b.updateUserInfo(e).then((e=>{S.setUserInfo({title:e.name,description:e.about}),B.close()})).catch((e=>{console.error(e)})).finally((()=>{B.renderLoadingText(!1)}))}});B.setEventListeners();const q=new r({popupSelector:"#edit-avatar-modal",handleFormSubmit:function(e){q.renderLoadingText(!0),b.updateAvatar(e).then((e=>{S.updateAvatar(e.avatar),q.close(),v.reset(),k.disableButton()})).catch((e=>{console.error("Error updating avatar",e)})).finally((()=>{q.renderLoadingText(!1)}))}});q.setEventListeners();const w=new class extends s{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._image=this._popupElement.querySelector(".modal__card-image"),this._title=this._popupElement.querySelector(".modal__card-title")}open(e,t){this._title.textContent=e,this._image.alt=e,this._image.src=t,super.open()}}({popupSelector:"#preview-image-modal"});w.setEventListeners();const x=new class extends s{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super({popupSelector:t}),this._handleFormSubmit=s,this._deleteButton=this._popupElement.querySelector(".modal__button_remove"),this._isSubmitted=!1,this._cardId=null,this._card=null}open(e,t){this._card=e,this._cardId=t,super.open()}getIsSubmitted(){return this._isSubmitted}confirmDeletion(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._deleteButton.addEventListener("click",(e=>{e.preventDefault(),this._isSubmitted=!0,this._handleFormSubmit(this._card,this._cardId)}))}}({popupSelector:"#remove-card-modal",handleFormSubmit:()=>{}});x.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TSxLQUFLOEUsY0FBYy9ELGNBQWMscUJBQ2pELENBRUFtRSxJQUFBQSxDQUFLaEMsRUFBTUUsR0FDVHBELEtBQUtvTSxPQUFPakwsWUFBYytCLEVBQzFCbEQsS0FBS21NLE9BQU96SCxJQUFNeEIsRUFDbEJsRCxLQUFLbU0sT0FBTzFILElBQU1yQixFQUNsQnVDLE1BQU1ULE1BQ1IsR0hxTzJDLENBQzNDTCxjQUFlLHlCQUVqQnVELEVBQWtCOUMsb0JBRWxCLE1BQU15RyxFQUF1QixJSXRQZCxjQUFtQ3BILEVBQ2hEOUUsV0FBQUEsQ0FBVytFLEdBQXNDLElBQXJDLGNBQUVDLEVBQWEsaUJBQUVhLEdBQWtCZCxFQUM3Q2UsTUFBTSxDQUFFZCxrQkFDUjdFLEtBQUs2RixrQkFBb0JILEVBQ3pCMUYsS0FBS3FNLGNBQWdCck0sS0FBSzhFLGNBQWMvRCxjQUN0Qyx5QkFFRmYsS0FBS3NNLGNBQWUsRUFDcEJ0TSxLQUFLdU0sUUFBVSxLQUNmdk0sS0FBS3dNLE1BQVEsSUFDZixDQUVBdEgsSUFBQUEsQ0FBSzRHLEVBQU1XLEdBQ1R6TSxLQUFLd00sTUFBUVYsRUFDYjlMLEtBQUt1TSxRQUFVRSxFQUNmOUcsTUFBTVQsTUFDUixDQUVBd0gsY0FBQUEsR0FDRSxPQUFPMU0sS0FBS3NNLFlBQ2QsQ0FFQU4sZUFBQUEsQ0FBZ0I1QyxHQUNkcEosS0FBSzZGLGtCQUFvQnVELENBQzNCLENBRUE5RCxpQkFBQUEsR0FDRUssTUFBTUwsb0JBQ050RixLQUFLcU0sY0FBYy9KLGlCQUFpQixTQUFVcUssSUFDNUNBLEVBQUlqSyxpQkFDSjFDLEtBQUtzTSxjQUFlLEVBQ3BCdE0sS0FBSzZGLGtCQUFrQjdGLEtBQUt3TSxNQUFPeE0sS0FBS3VNLFFBQVEsR0FFcEQsR0pxTm9ELENBQ3BEMUgsY0FBZSxxQkFDZmEsaUJBQWtCQSxTQUVwQnFHLEVBQXFCekcsbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy91dGlscy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwQ29uZmlybURlbGV0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZShpbnB1dEVsZW1lbnRzKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KGlucHV0RWxlbWVudHMpKSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KGlucHV0RWxlbWVudHMpIHtcclxuICAgIHJldHVybiBpbnB1dEVsZW1lbnRzLnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBjb25zdCBpbnB1dEVsZW1lbnRzID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRFbGVtZW50cyk7XHJcbiAgICBpbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZShpbnB1dEVsZW1lbnRzKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVMaWtlSWNvbixcclxuICAgIGhhbmRsZURlbGV0ZUNhcmRcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUljb24gPSBoYW5kbGVMaWtlSWNvbjtcclxuICAgIHRoaXMuaGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuaGFuZGxlRGVsZXRlQ2FyZCh0aGlzKTtcclxuICAgICAgfSk7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlUHJldmlldyh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbih0aGlzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VJY29uKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaGFuZGxlTGlrZShpc0xpa2VkKSB7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgfVxyXG5cclxuICBnZXRDYXJkSWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5pZDtcclxuICB9XHJcblxyXG4gIGdldElzTGlrZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faXNMaWtlZDtcclxuICB9XHJcblxyXG4gIHJlbW92ZSgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUltYWdlUHJldmlldygpIHtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XHJcbiAgfVxyXG5cclxuICBnZXRWaWV3KCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRUaXRsZUVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZFRpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXModGhpcy5faXNMaWtlZCk7XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgLy8gb3BlbnMgcG9wdXBcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICAvLyBjbG9zZXMgcG9wdXBcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZSkge1xuICAgIC8vIGxpc3RlbnMgZm9yIGVzYyBidXR0b25cbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBzZXRzIGV2ZW50IGxpc3RlbmVyc1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtVmFsdWVzID0ge307XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5fcG9wdXBGb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLl9wb3B1cEZvcm1WYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmdUZXh0KGlzTG9hZGluZywgdGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIC8vIFJlbmRlciBhbGwgZWxlbWVudHMgb24gdGhlIHBhZ2UuIEl0ZXJhdGUgdGhyb3VnaCBpdGVtcyBhcnJheSBhbmQgY2FsbCB0aGUgcmVuZGVyZXIgZnVuY3Rpb24gb24gZWFjaCBpdGVtLiBUaGlzIHNob3VsZCBiZSBjYWxsZWQgb25jZSBvbiBwYWdlIGxvYWQuXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGNhcmRFbGVtZW50KSB7XG4gICAgLy8gdGFrZXMgYSBET00gZWxlbWVudCBhbmQgYWRkcyBpdCB0byB0aGUgY29udGFpbmVyLiBTaG91bGQgYmUgY2FsbGVkIHdoZW4gYWRkaW5nIGFuIGluZGl2aWR1YWwgY2FyZCB0byB0aGUgRE9NLlxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGNhcmRFbGVtZW50KTtcbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5leHBvcnQgY29uc3QgZm9ybVZhbGlkYXRpb25Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG4iLCJpbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwQ29uZmlybURlbGV0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwQ29uZmlybURlbGV0aW9uLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IHsgZm9ybVZhbGlkYXRpb25Db25maWcgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcblxyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xyXG5jb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xyXG5jb25zdCBjaGFuZ2VBdml0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1hdmF0YXItbW9kYWxcIik7XHJcblxyXG5jb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxyXG4pO1xyXG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IGFkZENhcmRGb3JtID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmNvbnN0IGVkaXRBdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1idXR0b25cIik7XHJcbmNvbnN0IGF2YXRhckZvcm1FbGVtZW50ID0gY2hhbmdlQXZpdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2sobmFtZSwgbGluaykge1xyXG4gIHByZXZpZXdJbWFnZVBvcHVwLm9wZW4obmFtZSwgbGluayk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KHVzZXJEYXRhKSB7XHJcbiAgZWRpdFByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nVGV4dCh0cnVlKTtcclxuICBhcGlcclxuICAgIC51cGRhdGVVc2VySW5mbyh1c2VyRGF0YSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICAgIHRpdGxlOiByZXMubmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbjogcmVzLmFib3V0LFxyXG4gICAgICB9KTtcclxuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGVkaXRQcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZ1RleHQoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChsaW5rKSB7XHJcbiAgZWRpdEF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmdUZXh0KHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZUF2YXRhcihsaW5rKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICB1c2VySW5mby51cGRhdGVBdmF0YXIocmVzLmF2YXRhcik7XHJcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5jbG9zZSgpO1xyXG4gICAgICBhdmF0YXJGb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gICAgICBhdmF0YXJGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgYXZhdGFyXCIsIGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBlZGl0QXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZ1RleHQoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoZGF0YSkge1xyXG4gIC8vIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gIG5ld0NhcmRQb3B1cC5yZW5kZXJMb2FkaW5nVGV4dCh0cnVlKTtcclxuICBhcGlcclxuICAgIC5hZGRDYXJkKHtcclxuICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICBsaW5rOiBkYXRhLmxpbmssXHJcbiAgICAgIF9pZDogZGF0YS5pZCxcclxuICAgICAgaXNMaWtlZDogZGF0YS5pc0xpa2VkLFxyXG4gICAgfSlcclxuICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICByZW5kZXJDYXJkKGNhcmREYXRhKTtcclxuICAgICAgbmV3Q2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIGFkZENhcmRGb3JtLnJlc2V0KCk7XHJcbiAgICAgIGFkZENhcmRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3aGlsZSBhZGRpbmcgY2FyZFwiLCBlcnJvcik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBuZXdDYXJkUG9wdXAucmVuZGVyTG9hZGluZ1RleHQoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmVkaXRBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGVkaXRBdmF0YXJQb3B1cC5vcGVuKCkpO1xyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCBkYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IGRhdGEubmFtZTtcclxuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IGRhdGEuZGVzY3JpcHRpb247XHJcbiAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gbmV3Q2FyZFBvcHVwLm9wZW4oKSk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG4gIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19pbWFnZVwiLFxyXG59KTtcclxuXHJcbi8vIEFQSVxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI2ZjA3Y2IzNy1lOWE4LTRmMTktYWQ3ZS1lMzNlZDdiNTg1ODBcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxubGV0IHNlY3Rpb247XHJcblxyXG5hcGlcclxuICAuZ2V0QWxsRGF0YSgpXHJcbiAgLnRoZW4oKFtpbml0aWFsQ2FyZHMsIHVzZXJEYXRhXSkgPT4ge1xyXG4gICAgdXNlckluZm8udXBkYXRlQXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIHRpdGxlOiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogdXNlckRhdGEuYWJvdXQsXHJcbiAgICB9KTtcclxuICAgIHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgICAge1xyXG4gICAgICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbiAgICAgICAgcmVuZGVyZXI6IHJlbmRlckNhcmQsXHJcbiAgICAgIH0sXHJcbiAgICAgIFwiLmNhcmRzX19saXN0XCJcclxuICAgICk7XHJcbiAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcclxuXHJcbi8vIEZvcm0gVmFsaWRhdGlvblxyXG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGZvcm1WYWxpZGF0aW9uQ29uZmlnLFxyXG4gIGFkZENhcmRGb3JtXHJcbik7XHJcbmFkZENhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGZvcm1WYWxpZGF0aW9uQ29uZmlnLFxyXG4gIHByb2ZpbGVFZGl0Rm9ybVxyXG4pO1xyXG5lZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGZvcm1WYWxpZGF0aW9uQ29uZmlnLFxyXG4gIGF2YXRhckZvcm1FbGVtZW50XHJcbik7XHJcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLy8gQ2FyZHNcclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmREYXRhLFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZUxpa2VJY29uLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2FyZFxyXG4gICk7XHJcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xyXG59XHJcblxyXG5jb25zdCByZW5kZXJDYXJkID0gKGNhcmREYXRhKSA9PiB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcclxuICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG59O1xyXG5cclxuLy8gaGFuZGxlIExpa2UgSWNvblxyXG5mdW5jdGlvbiBoYW5kbGVMaWtlSWNvbihjYXJkKSB7XHJcbiAgaWYgKGNhcmQuZ2V0SXNMaWtlZCgpKSB7XHJcbiAgICBhcGlcclxuICAgICAgLnJlbW92ZUxpa2UoY2FyZC5nZXRDYXJkSWQoKSlcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmQuaGFuZGxlTGlrZShmYWxzZSk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICB9KTtcclxuICB9IGVsc2Uge1xyXG4gICAgYXBpXHJcbiAgICAgIC5hZGRMaWtlKGNhcmQuZ2V0Q2FyZElkKCkpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjYXJkLmhhbmRsZUxpa2UodHJ1ZSk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbi8vIGhhbmRsZSBkZWxldGluZyBjYXJkc1xyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmQpIHtcclxuICBjb25maXJtRGVsZXRpb25Qb3B1cC5vcGVuKCk7XHJcbiAgY29uZmlybURlbGV0aW9uUG9wdXAuY29uZmlybURlbGV0aW9uKCgpID0+IHtcclxuICAgIGFwaVxyXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLmdldENhcmRJZCgpKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgLy8gd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgIGNhcmQucmVtb3ZlKCk7XHJcbiAgICAgICAgY29uZmlybURlbGV0aW9uUG9wdXAuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgY2FyZFwiLCBlcnIpO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuLy8gSW5zdGFjZSBvZiBTZWN0aW9uIGNsYXNzXHJcblxyXG4vLyBjb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbi8vICAgeyBpdGVtczogaW5pdGlhbENhcmRzLCByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LFxyXG4vLyAgIFwiLmNhcmRzX19saXN0XCJcclxuLy8gKTtcclxuLy8gc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG5cclxuLy8gUG9wdXBzXHJcblxyXG5jb25zdCBuZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjYWRkLWNhcmQtbW9kYWxcIixcclxuICBoYW5kbGVGb3JtU3VibWl0OiBoYW5kbGVBZGRDYXJkU3VibWl0LFxyXG59KTtcclxubmV3Q2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0LFxyXG59KTtcclxuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgZWRpdEF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI2VkaXQtYXZhdGFyLW1vZGFsXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlQXZhdGFyU3VibWl0LFxyXG59KTtcclxuZWRpdEF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBwcmV2aWV3SW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiLFxyXG59KTtcclxucHJldmlld0ltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGNvbmZpcm1EZWxldGlvblBvcHVwID0gbmV3IFBvcHVwQ29uZmlybURlbGV0aW9uKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNyZW1vdmUtY2FyZC1tb2RhbFwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6ICgpID0+IHt9LFxyXG59KTtcclxuY29uZmlybURlbGV0aW9uUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2pvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9qb2IudGV4dENvbnRlbnQsXHJcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyLnNyYyxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyhkYXRhKSB7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gZGF0YS50aXRsZTtcclxuICAgIHRoaXMuX2pvYi50ZXh0Q29udGVudCA9IGRhdGEuZGVzY3JpcHRpb247XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlUHJvbWlzZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVByb21pc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVByb21pc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0QWxsRGF0YSgpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVVc2VySW5mbyh1c2VyRGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IHVzZXJEYXRhLnRpdGxlLFxyXG4gICAgICAgIGFib3V0OiB1c2VyRGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVByb21pc2UpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlQXZhdGFyKGxpbmspIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShsaW5rKSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUHJvbWlzZSk7XHJcbiAgfVxyXG5cclxuICBhZGRMaWtlKElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUHJvbWlzZSk7XHJcbiAgfVxyXG5cclxuICByZW1vdmVMaWtlKElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUHJvbWlzZSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkKHsgbmFtZSwgbGluaywgX2lkLCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluaywgX2lkIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVQcm9taXNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke0lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVQcm9taXNlKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXJkLWltYWdlXCIpO1xyXG4gICAgdGhpcy5fdGl0bGUgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FyZC10aXRsZVwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgdGhpcy5fdGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cENvbmZpcm1EZWxldGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX2J1dHRvbl9yZW1vdmVcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2lzU3VibWl0dGVkID0gZmFsc2U7XHJcbiAgICB0aGlzLl9jYXJkSWQgPSBudWxsO1xyXG4gICAgdGhpcy5fY2FyZCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBvcGVuKGNhcmQsIGNhcmRJZCkge1xyXG4gICAgdGhpcy5fY2FyZCA9IGNhcmQ7XHJcbiAgICB0aGlzLl9jYXJkSWQgPSBjYXJkSWQ7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG5cclxuICBnZXRJc1N1Ym1pdHRlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pc1N1Ym1pdHRlZDtcclxuICB9XHJcblxyXG4gIGNvbmZpcm1EZWxldGlvbihhcGkpIHtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBhcGk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2lzU3VibWl0dGVkID0gdHJ1ZTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9jYXJkLCB0aGlzLl9jYXJkSWQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsInJlbW92ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRFbGVtZW50cyIsIl9oYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlQnV0dG9uIiwiX2VuYWJsZUJ1dHRvbiIsInNvbWUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZGlzYWJsZWQiLCJlbmFibGVWYWxpZGF0aW9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwiQ2FyZCIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlTGlrZUljb24iLCJoYW5kbGVEZWxldGVDYXJkIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2lzTGlrZWQiLCJpc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZUxpa2VJY29uIiwiX2NhcmRFbGVtZW50IiwiX2NhcmRJbWFnZUVsZW1lbnQiLCJfaGFuZGxlSW1hZ2VQcmV2aWV3IiwiX2xpa2VCdXR0b24iLCJ0b2dnbGUiLCJfcmVuZGVyTGlrZXMiLCJoYW5kbGVMaWtlIiwiZ2V0Q2FyZElkIiwiZ2V0SXNMaWtlZCIsImdldFZpZXciLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfY2FyZFRpdGxlRWxlbWVudCIsInNyYyIsImFsdCIsIlBvcHVwIiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2Nsb3NlQnV0dG9uIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9zdWJtaXRCdXR0b25UZXh0IiwiX2lucHV0TGlzdCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9wb3B1cEZvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJyZW5kZXJMb2FkaW5nVGV4dCIsImlzTG9hZGluZyIsInRleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJjYXJkRWxlbWVudCIsInByZXBlbmQiLCJmb3JtVmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRNb2RhbCIsImFkZENhcmRNb2RhbCIsImNoYW5nZUF2aXRhck1vZGFsIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsInByb2ZpbGVFZGl0Rm9ybSIsImFkZENhcmRGb3JtIiwiYWRkTmV3Q2FyZEJ1dHRvbiIsImVkaXRBdmF0YXJCdXR0b24iLCJhdmF0YXJGb3JtRWxlbWVudCIsInByZXZpZXdJbWFnZVBvcHVwIiwiZWRpdEF2YXRhclBvcHVwIiwidXNlckluZm8iLCJnZXRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwiZWRpdFByb2ZpbGVQb3B1cCIsIm5ld0NhcmRQb3B1cCIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfam9iIiwiX2F2YXRhciIsImF2YXRhciIsInNldFVzZXJJbmZvIiwidGl0bGUiLCJ1cGRhdGVBdmF0YXIiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfaGFuZGxlUHJvbWlzZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJnZXRBbGxEYXRhIiwiYWxsIiwidXBkYXRlVXNlckluZm8iLCJ1c2VyRGF0YSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJhZGRMaWtlIiwiSWQiLCJyZW1vdmVMaWtlIiwiYWRkQ2FyZCIsIl9yZWYyIiwiZGVsZXRlQ2FyZCIsImF1dGhvcml6YXRpb24iLCJzZWN0aW9uIiwiaW5pdGlhbENhcmRzIiwicmVuZGVyQ2FyZCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiLCJhdmF0YXJGb3JtVmFsaWRhdG9yIiwiY2FyZERhdGEiLCJjcmVhdGVDYXJkIiwiY2FyZCIsImNvbmZpcm1EZWxldGlvblBvcHVwIiwiY29uZmlybURlbGV0aW9uIiwicmVzZXQiLCJmaW5hbGx5IiwiX2ltYWdlIiwiX3RpdGxlIiwiX2RlbGV0ZUJ1dHRvbiIsIl9pc1N1Ym1pdHRlZCIsIl9jYXJkSWQiLCJfY2FyZCIsImNhcmRJZCIsImdldElzU3VibWl0dGVkIiwiZXZ0Il0sInNvdXJjZVJvb3QiOiIifQ==